import{s as X,R as Y}from"./roslib-CVfGsBJM.js";var q={};const Z={},$=Object.freeze(Object.defineProperty({__proto__:null,default:Z},Symbol.toStringTag,{value:"Module"})),F=Y($);var V;function K(){return V||(V=1,function(S){var _=F,O=F,j=F,C=new Buffer("89504e470d0a1a0a","hex");function D(o,b,a,n,e){this.width=o,this.height=b,this.channels=a,this.data=n,this.trailer=e}D.prototype.getPixel=function(o,b){if(o=o|0,b=b|0,o<0||b<0||o>=this.width||b>=this.height)return 0;var a=(b*this.width+o)*this.channels,n,e,f,v;switch(this.channels){case 1:n=e=f=this.data[a],v=255;break;case 2:n=e=f=this.data[a],v=this.data[a+1];break;case 3:n=this.data[a],e=this.data[a+1],f=this.data[a+2],v=255;break;case 4:n=this.data[a],e=this.data[a+1],f=this.data[a+2],v=this.data[a+3];break}return(n<<24|e<<16|f<<8|v)>>>0};function W(o,b,a){var n=o+b-a,e=Math.abs(n-o),f=Math.abs(n-b),v=Math.abs(n-a);return e<=f&&e<=v?o:f<=v?b:a}S.parseStream=function(o,b){var a=j.createInflate(),n=0,e=0,f=new Buffer(13),v=2,l=-1,d=0,z=0,H=0,u,R,L,I,y,x,i,B,w,N,s,p,P,A,G,k,T,E;function h(c){return o.destroy&&o.destroy(),a.destroy&&a.destroy(),b(c)}function J(){if(!--v)return b(void 0,new D(R,L,E,i,G))}o.on("error",h),a.on("error",h),o.on("end",function(){return o.destroy(),i?G?J():h(new Error("Corrupt PNG?")):h(new Error("Corrupt PNG?"))}),a.on("end",function(){return a.destroy&&a.destroy(),d!==i.length?h(new Error("Too little pixel data! (Corrupt PNG?)")):J()}),o.on("data",function(c){if(o.readable)for(var t=c.length,r=0,M,g;r!==t;)switch(n){case 0:if(c[r++]!==C[e++])return h(new Error("Invalid PNG header."));e===C.length&&(n=1,e=0);break;case 1:if(t-r<8-e)c.copy(f,e,r),e+=t-r,r=t;else switch(c.copy(f,e,r,r+8-e),r+=8-e,e=0,u=f.readUInt32BE(0),f.toString("ascii",4,8)){case"IHDR":n=2;break;case"PLTE":if(x!==3)n=7;else{if(u%3!==0)return h(new Error("Invalid PLTE size."));z=u/3,k=new Buffer(u),n=3}break;case"tRNS":if(x!==3)return h(new Error("tRNS for non-paletted images not yet supported."));E++,H=u,T=new Buffer(u),n=4;break;case"IDAT":i||(i=new Buffer(R*L*E)),n=5;break;case"IEND":n=6;break;default:n=7;break}break;case 2:if(u!==13)return h(new Error("Invalid IHDR chunk."));if(t-r<u-e)c.copy(f,e,r),e+=t-r,r=t;else{if(c.copy(f,e,r,r+u-e),f.readUInt8(10)!==0)return h(new Error("Unsupported compression method."));if(f.readUInt8(11)!==0)return h(new Error("Unsupported filter method."));if(f.readUInt8(12)!==0)return h(new Error("Unsupported interlace method."));switch(r+=u-e,n=8,e=0,R=f.readUInt32BE(0),L=f.readUInt32BE(4),I=f.readUInt8(8),y=255/((1<<I)-1),x=f.readUInt8(9),x){case 0:B=1,w=Math.ceil(I*.125),E=1;break;case 2:B=3,w=Math.ceil(I*.375),E=3;break;case 3:B=1,w=1,E=3;break;case 4:B=2,w=Math.ceil(I*.25),E=2;break;case 6:B=4,w=Math.ceil(I*.5),E=4;break;default:return h(new Error("Unsupported color type: "+x))}N=Math.ceil(R*I*B/8),s=new Buffer(B),p=new Buffer(N),P=new Buffer(N),p.fill(0)}break;case 3:if(t-r<u-e)c.copy(k,e,r),e+=t-r,r=t;else for(c.copy(k,e,r,r+u-e),r+=u-e,n=8,e=0,E=1,g=z;g--;)if(k[g*3+0]!==k[g*3+1]||k[g*3+0]!==k[g*3+2]){E=3;break}break;case 4:t-r<u-e?(c.copy(T,e,r),e+=t-r,r=t):(c.copy(T,e,r,r+u-e),r+=u-e,n=8,e=0);break;case 5:t-r<u-e?(a.write(c.slice(r)),e+=t-r,r=t):(a.write(c.slice(r,r+u-e)),r+=u-e,n=8,e=0);break;case 6:if(u!==0)return h(new Error("Invalid IEND chunk."));t-r<4-e?(e+=t-r,r=t):(G=new Buffer(0),r+=4-e,n=9,e=0,a.end());break;case 7:t-r<u-e?(e+=t-r,r=t):(r+=u-e,n=8,e=0);break;case 8:t-r<4-e?(e+=t-r,r=t):(r+=4-e,n=1,e=0);break;case 9:M=new Buffer(e+t-r),G.copy(M),c.copy(M,e,r,t),G=M,e+=t-r,r=t;break}}),a.on("data",function(c){if(a.readable){var t=c.length,r,M,g,m,U;for(r=0;r!==t;++r){if(l===-1)A=c[r],M=p,p=P,P=M;else switch(A){case 0:p[l]=c[r];break;case 1:p[l]=l<w?c[r]:c[r]+p[l-w]&255;break;case 2:p[l]=c[r]+P[l]&255;break;case 3:p[l]=c[r]+((l<w?P[l]:p[l-w]+P[l])>>>1)&255;break;case 4:p[l]=c[r]+(l<w?P[l]:W(p[l-w],P[l],P[l-w]))&255;break;default:return h(new Error("Unsupported scanline filter: "+A))}if(++l===N){if(d===i.length)return h(new Error("Too much pixel data! (Corrupt PNG?)"));for(m=0,g=0;g!==R;++g){for(U=0;U!==B;++m,++U)switch(I){case 1:s[U]=p[m>>>3]>>7-(m&7)&1;break;case 2:s[U]=p[m>>>2]>>(3-(m&3)<<1)&3;break;case 4:s[U]=p[m>>>1]>>(1-(m&1)<<2)&15;break;case 8:s[U]=p[m];break;default:return h(new Error("Unsupported bit depth: "+I))}switch(x){case 0:i[d++]=s[0]*y;break;case 2:i[d++]=s[0]*y,i[d++]=s[1]*y,i[d++]=s[2]*y;break;case 3:if(s[0]>=z)return h(new Error("Invalid palette index."));switch(E){case 1:i[d++]=k[s[0]*3];break;case 2:i[d++]=k[s[0]*3],i[d++]=s[0]<H?T[s[0]]:255;break;case 3:i[d++]=k[s[0]*3+0],i[d++]=k[s[0]*3+1],i[d++]=k[s[0]*3+2];break;case 4:i[d++]=k[s[0]*3+0],i[d++]=k[s[0]*3+1],i[d++]=k[s[0]*3+2],i[d++]=s[0]<H?T[s[0]]:255;break}break;case 4:i[d++]=s[0]*y,i[d++]=s[1]*y;break;case 6:i[d++]=s[0]*y,i[d++]=s[1]*y,i[d++]=s[2]*y,i[d++]=s[3]*y;break}}l=-1}}}})},S.parseFile=function(o,b){return S.parseStream(_.createReadStream(o),b)},S.parseBuffer=function(o,b){var a=new O.Stream;a.readable=!0,a.destroy=function(){a.readable=!1},S.parseStream(a,b),a.emit("data",o),a.readable&&a.emit("end")},S.parse=S.parseBuffer}(q)),q}var Q=K();const rr=X(Q);function ar(S,_){var O=new Buffer(S,"base64");rr.parse(O,function(j,C){if(j)console.warn("Cannot process PNG encoded message ");else{var D=C.data.toString();_(JSON.parse(D))}})}export{ar as default};
